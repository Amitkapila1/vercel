const async=require("async"),express=require("express");var https=require("https"),compression=require("compression");const merge=require("deepmerge");var http=require("http");const app=express(),port=3e3;var cookieSession=require("cookie-session");const{JSDOM:JSDOM}=require("jsdom"),{window:window}=new JSDOM(""),$=require("jquery")(window),chrome=require("chrome-cookies-secure"),cors=require("cors");var cookieParser=require("cookie-parser");app.use(cookieParser()),app.use(compression());const bodyParser=require("body-parser"),request=require("request");app.use(cors());const path=require("path"),session=require("express-session");app.use(bodyParser.json({limit:"50mb"})),app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.raw());const fetch=require("node-fetch"),csrf=require("csurf");process.env.chartinkcsrf="IeyxllMLHFKfCD4Yby7Sw1g9XWJhX5XJjsGfwtnW",process.env.chartinkcookie='_ga=GA1.2.2067931904.1621586668; bfp_sn_rf_8b2087b102c9e3e5ffed1c1478ed8b78=Direct; bafp=0590ba80-e319-11ea-a890-4395e7b43464; __gads=ID=eb4d407b97097fa6-22285d39c9c800fa:T=1621586677:RT=1621586677:S=ALNI_MZ3vScH0DJGPYFS_YkChWPH5KiAFg; remember_web_59ba36addc2b2f9401580f014c7f58ea4e30989d=eyJpdiI6IjFNR1pXdzlYUjlMa25jRGJ3K21FOWc9PSIsInZhbHVlIjoiV1pXSTlIWVZRYUErMllpQk1BMEVQa2tUN3R1bDFsbkZFWU5NeWdWbE4wbFByTEd1SHZRVTkrcDlUdTNoWTJySkVObTJ0cVNKanVpTTRmNlhjSExQak5lM3paNWt4MDVsdW9kQ2dGMG05ZkhXZDROeUlkVlg5U1B6MEdCdHlWQVwvSHZYZ0FGalRQQ2JFRlN6U0pZTXhMQVpESkRoNUlpbDJUWVZcL3FsVWdSMXJjeE1JTmhkMkJyK1dITmpiUUF6cGkiLCJtYWMiOiJlM2E1MzY2NzMwZTcwYWYyMjcxOTY0OGYxMDJhMTJiODkyNzQyMTUwOWZjODZlOTdmZDZlYThiMDFkNTM3Yzk4In0%3D; __utmz=102564947.1627487103.1.1.utmcsr=(direct)|utmccn=(direct)|utmcmd=(none); __utma=102564947.2067931904.1621586668.1629460093.1630149430.5; mnjs_session_depth=1%7C1630270688592; _gid=GA1.2.1238159065.1630270689; _yeti_currency_={"dataAsOf":"2021-08-27T00:00:00.000Z","generatedAt":"2021-08-28T15:00:47.619Z","conversions":{"USD":{"USD":1,"JPY":110.18620865572656,"BGN":1.6629538304565938,"CZK":21.735396649944732,"DKK":6.322846696709464,"GBP":0.7287050420882578,"HUF":298.3334750446391,"PLN":3.896522404557436,"RON":4.195221494770853,"SEK":8.702066150837515,"CHF":0.9179491539835047,"ISK":126.85996088767962,"NOK":8.806649094464756,"HRK":6.367315704446901,"RUB":74.01998129410765,"TRY":8.401411444605051,"AUD":1.3791344273446138,"BRL":5.245472323781992,"CAD":1.2680894481761755,"CNY":6.47861576396565,"HKD":7.790068871694584,"IDR":14428.152367995921,"ILS":3.231612958081796,"INR":73.71907150752487,"KRW":1169.7814811665676,"MXN":20.379729614828673,"MYR":4.19003486098121,"NZD":1.439248363234419,"PHP":49.95663634044724,"SGD":1.350905535243602,"THB":32.65538644673072,"ZAR":14.909956636340446,"EUR":0.8502678343678259},"GBP":{"USD":1.3722973524847437,"JPY":151.20824241858512,"BGN":2.282067138839947,"CZK":29.827427277924926,"DKK":8.676825782061306,"GBP":1,"HUF":409.4022379613316,"PLN":5.347187379671657,"RON":5.757091350361131,"SEK":11.941822339941426,"CHF":1.259699193727174,"ISK":174.0895884624809,"NOK":12.085341236596152,"HRK":8.737850483647014,"RUB":101.57742436087419,"TRY":11.529234682566539,"AUD":1.8925825233655766,"BRL":7.198347782458024,"CAD":1.7401957924460056,"CNY":8.890587260655987,"HKD":10.690290888300293,"IDR":19799.715295847287,"ILS":4.43473390663104,"INR":101.1644866574099,"KRW":1605.2880295905627,"MXN":27.967048994784314,"MYR":5.749973746543295,"NZD":1.975076718434594,"PHP":68.55535978903889,"SGD":1.8538440894717805,"THB":44.81290036521475,"ZAR":20.46089401771233,"EUR":1.1668202980059041}}}; bfp_sn_rt_8b2087b102c9e3e5ffed1c1478ed8b78=1630270689826; XSRF-TOKEN=eyJpdiI6ImxYbmtYZWJBQWdOMG1XdkZWYkIxOVE9PSIsInZhbHVlIjoiTk0rODBINVFERkRwNEQ3RXMybStWMkI3ZUpGWkhoVWx6elU1SldtcDVIUUFuRWtGY3J2R2RhR3Z5Snp0a2pJMiIsIm1hYyI6ImI2M2RiMTk5MDljNTgyNjhiZDIyYjI0NDhjM2YwMjE2ZWMxYzcwN2Q4NmE4Mjg2ZWI4ODVhZDg1MmRmNTJmOGEifQ%3D%3D; ci_session=eyJpdiI6Im5FZHF1WmU0T2lmVDJ3cjlnSDJmZGc9PSIsInZhbHVlIjoiTFg1U0k2YTVcL3dxRWFXclZhQlQ4Qkp4Q1BURll2RE1KT2JwU1FoMmFxakg5VVpYa3RCcFFoNTZPanJHZVFOVGUiLCJtYWMiOiI1Y2EyZmJmNGZkNDZmOWFhNGNiMzgyOGE1NTEwNGJiMTFkYWNlZWQ2NGUwZjVhODFmMDYyNGY5NzZiN2MzNDMzIn0%3D; _gat=1',process.env.trendlynecookie="_ga=GA1.2.775644955.1603113261; __utma=185246956.775644955.1603113261.1614010114.1614018734.3; csrftoken=StkPPTJQR96B1eNyk1kO8u7w0CxvszLE9GCFZXgYbaMa6XzTYRzzAYZtrgicRChA; .trendlyne=xl0m433d7ipeuh5in913buwwa5tw0su3; _gid=GA1.2.1123277276.1649936867; _gat=1";var csrfProtection=csrf({cookie:!0}),parseForm=bodyParser.urlencoded({extended:!1});const fs=require("fs"),axios=require("axios"),cheerio=require("cheerio");var html2json=require("html2json").html2json;const token="1869116798:AAHmOnd_R4vqQZpAdYpT--EPdXuP8WjZc00",axiosCookieJarSupport=require("axios-cookiejar-support").default,tough=require("tough-cookie"),{response:response}=require("express"),{json:json}=require("body-parser");var moment=require("moment");app.get("/mcnifty50",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=5d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=1m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=3m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=6m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=1yr&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3BNSX?field=RSI"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3BNSX?field=RSI"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/nifty50frequent",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=9&range=1d&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3BNSX?field=RSI"},{url:"https://mo.streak.tech/api/tech_analysis/?timeFrame=day&stock=INDICES%3ANIFTY%2050"},{url:"https://api.niftytrader.in/api/FinNiftyOI/niftypcrData?reqType=niftypcr"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=36&range=1d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/marketmap&format=json&type=0&ind_id=9"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/mcniftybank",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=5d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=1m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=3m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=6m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=1yr&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3Bnbx?field=RSI"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3Bnbx?field=RSI"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/niftybankfrequent",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=23&range=1d&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3Bnbx?field=RSI"},{url:"https://mo.streak.tech/api/tech_analysis/?timeFrame=day&stock=INDICES%3ANIFTY%20BANK"},{url:"https://api.niftytrader.in/api/FinNiftyOI/niftypcrData?reqType=bankniftypcr"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=36&range=1d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/marketmap&format=json&type=0&ind_id=23"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/mcniftypharma",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=5d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=1m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=3m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=6m&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=1yr&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3Bcpr?field=RSI"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3Bcpr?field=RSI"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/niftypharmafrequent",((e,t)=>{const o=[{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=41&range=1d&type=area"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3Bcpr?field=RSI"},{url:"https://mo.streak.tech/api/tech_analysis/?timeFrame=day&stock=INDICES%3ANIFTY%20PHARMA"},{url:"https://api.niftytrader.in/api/FinNiftyOI/niftypcrData?reqType=niftypcr"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=36&range=1d&type=area"},{url:"https://appfeeds.moneycontrol.com/jsonapi/market/marketmap&format=json&type=0&ind_id=9"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(o,((e,o)=>{e?console.error("Error: ",e):t.json(o)}))})),app.get("/mcshare",((e,t)=>{let o=e.query.mcsymbol,n=e.query.eqsymbol,s=e.query.stockid;console.log(o),console.log(n),console.log("This is mcshare");const a=[{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/W/"+o+"?field=RSI"},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/M/"+o+"?field=RSI"},{url:"https://etelection.indiatimes.com/ET_Charts/delaycharts?scripcode="+n+"EQ&exchangeid=50&datatype=eod&filtertype=eod&lastreceivedataid=&directions=back&scripcodetype=company&uptodataid=&period=1w"},{url:"https://etelection.indiatimes.com/ET_Charts/delaycharts?scripcode="+n+"EQ&exchangeid=50&datatype=eod&filtertype=eod&lastreceivedataid=&directions=back&scripcodetype=company&uptodataid=&period=1m"},{url:"https://etelection.indiatimes.com/ET_Charts/delaycharts?scripcode="+n+"EQ&exchangeid=50&datatype=eod&filtertype=eod&lastreceivedataid=&directions=back&scripcodetype=company&uptodataid=&period=3m"},{url:"https://etelection.indiatimes.com/ET_Charts/delaycharts?scripcode="+n+"EQ&exchangeid=50&datatype=eod&filtertype=eod&lastreceivedataid=&directions=back&scripcodetype=company&uptodataid=&period=6m"},{url:"https://etelection.indiatimes.com/ET_Charts/delaycharts?scripcode="+n+"EQ&exchangeid=50&datatype=eod&filtertype=eod&lastreceivedataid=&directions=back&scripcodetype=company&uptodataid=&period=1y"},{url:"https://frapi.marketsmojo.com/stocks_Pricemovement/pricemovement_info?sid="+s+"&exchange=1&1y=1&"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{t(e,JSON.parse(n))}))}(e,t)));async.parallel(a,((e,o)=>{e?console.error("Error in mcshare: ",e):t.json(o)}))})),app.get("/mcsharefrequent",((e,t)=>{let o=e.query.mcsymbol,n=e.query.eqsymbol;console.log("This is mcsharefrequent");const s=[{url:"https://mo.streak.tech/api/tech_analysis/?timeFrame=day&stock=NSE%3A"+n},{url:"https://priceapi.moneycontrol.com/pricefeed/techindicator/D/"+o+"?field=RSI"},{url:"https://www.moneycontrol.com/mc/widget/stockdetails/getChartInfo?classic=true&scId="+o+"&resolution=1D"},{url:"https://api.moneycontrol.com/mcapi/v1/extdata/mc-insights?scId="+o+"&type=d"},{url:"https://api.moneycontrol.com/mcapi/v1/extdata/mc-insights?scId="+o+"&type=c"},{url:"https://api.moneycontrol.com/mcapi/v1/extdata/mc-essentials?scId="+o+"&type=ed"},{url:"https://json.bselivefeeds.indiatimes.com/ETLiveFeedChartRead/livechartsnew?scripcode="+n+"EQ&exchangeid=50&datatype=intraday&filtertype=1MIN&firstreceivedataid=&lastreceivedataid=&directions=all&scripcodetype=company&uptodataid=&period=1d"}].map((e=>t=>function(e,t){request(e,((e,o,n)=>{console.log(e),t(e,JSON.parse(n))}))}(e,t)));async.parallel(s,((e,o)=>{e?console.error("Error in mcsharefrequent: ",e):t.json(o)}))}));var yesterday1=moment().subtract(1,"days"),yesterday2=moment().subtract(2,"days"),yesterday3=moment().subtract(3,"days"),yesterday4=moment().subtract(4,"days"),yesterday5=moment().subtract(5,"days"),yesterday6=moment().subtract(6,"days"),today=new Date;global.document=new JSDOM("http://localhost:4200/Dashboard").window.document,console.log(document.cookie);var dd=String(today.getDate()).padStart(2,"0"),mm=String(today.getMonth()+1).padStart(2,"0"),yyyy=today.getFullYear(),d=new Date,y=d.setDate(d.getDate()-1),month=new Array;month[0]="Jan",month[1]="Feb",month[2]="Mar",month[3]="Apr",month[4]="May",month[5]="Jun",month[6]="Jul",month[7]="Aug",month[8]="Sep",month[9]="Oct",month[10]="Nov",month[11]="Dec";var n=month[d.getMonth()],datetoday=dd+"-"+n+"-"+yyyy;yesterday=dd-1+mm+yyyy;var todaydate=dd+"-"+mm+"-"+yyyy,gnewsdatetoday=yyyy+"-"+mm+"-"+dd,gnewsyesterday=yyyy+"-"+mm+"-"+(dd-1);app.get("/mmmacd",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectMacd_macd_m",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmrsi",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectRsi_rsi_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmbb",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectBb_bb_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmma",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectMa_ma_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmkst",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectKst_kst_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmdow",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectDow_dow_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmobv",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectObv_obv_w",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmmarkets",(function(e,t){request("https://frapi.marketsmojo.com/market_marketoverview/getData?",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mmstockinfo",(function(e,t){let o=e.query.stockid;request("https://frapi.marketsmojo.com/stocks_stocksid/header_info?sid="+o+"&exchange=1",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmrecos",(function(e,t){request("https://www.marketsmojo.com/recommendation/api/getRecos.php?sortColumn=DATE&sortDirection=desc&page=1&pageSize=250&format=json&TPeriod%5B%5D=1week&CType%5B%5D=2&CType%5B%5D=1&CType%5B%5D=3",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mmmaxbuyrecos",(function(e,t){request("https://www.marketsmojo.com/recommendation/api/getRecos.php?List=buy&sortColumn=MAXCAL&sortDirection=asc&page=1&pageSize=50&format=json",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mmpeers",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectPrice_indiScale",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmpmov",(function(e,t){let o=e.query.stockid;request("https://frapi.marketsmojo.com/stocks_Pricemovement/pricemovement_info?sid="+o+"&exchange=0&1d",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mmtechscore",(function(e,t){let o=e.query.stockid;request("https://www.marketsmojo.com/technical_card/getCardInfo?sid="+o+"&se=nse&cardlist=sectPrice_techScore",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqma",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpivi",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpivd",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpdvi",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpdvd",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpfvi",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bq52wkh",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bq52wkl",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqc52h",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqc52l",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqvolatile",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqffh",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqrfl",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqbulkdeal",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqblockdeal",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqinsider",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqob",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqos",(function(e,t){let o=e.query.type;request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?type="+o+"&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqtg",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?duration=1D&type=top_gainers&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqtl",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/indices/stock-stats?duration=1D&type=top_losers&filter_key=index&filter_value=129",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqmovement",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/movement?duration=1D",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpricestats",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/"+o+"/price-stats",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqfundamentals",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/fundamentals",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqmovingaverages",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/moving-averages",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqdelvol",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/delivery-volumes",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqqresults",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/quarterly-results",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqtr",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/total-returns",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqss",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/shareholding-snapshot",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqsc",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/shareholding-comparison",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqph",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/promoter-holding",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqks",(function(e,t){let o=e.query.stockisin;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/key-statistics",(function(e,t,o){}))})),app.get("/bqannouncements",(function(e,t){let o=e.query.stockisin;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/announcements",(function(e,t,o){}))})),app.get("/bqca",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/corporate-actions",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqpd",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/peer-details",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqitnews",(function(e,t){let o=e.query.bqnames;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/in-the-news",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqnews",(function(e,t){let o=e.query.bqname;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/in-the-news",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqbdetails",(function(e,t){let o=e.query.stockid;request("https://www.bloombergquint.com/next/feapi/stock/"+o+"/stock-dna",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqgainingsectorsstocks",(function(e,t){let o=e.query.sectorid;request("https://www.bloombergquint.com/feapi/markets/indices/"+o+"/details?duration=1D",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqgainingsectorsstocksdetails",(function(e,t){let o=e.query.sectorid;request("https://www.bloombergquint.com/feapi/markets/indices/"+o+"/stocks?duration=1D",(function(e,o,n){e?console.log(e):e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqadvdec",(function(e,t){e.query.mcsymbol;request("https://www.bloombergquint.com/feapi/markets/indices/advances-declines",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/bqsectoralmovement",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/sectoral-movements?limit=100",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionslexpiryindex",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/put-call-ratio/last-expiry?security-type=index&limit=200",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionslexpirystock",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/put-call-ratio/last-expiry?security-type=stock&limit=200",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsputcallrindex",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/put-call-ratio?security-type=index&limit=20",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsputcallrstock",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/put-call-ratio?security-type=stock&limit=20",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsindexweekly",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/NIFTY%2050/?expiry=1w",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsindexmonthly",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/NIFTY%2050/?expiry=1m",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsbnindexweekly",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/NIFTY%20BANK/?expiry=1w",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqoptionsbnindexmonthly",(function(e,t){request("https://www.bloombergquint.com/feapi/markets/options/NIFTY%20BANK/?expiry=1m",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/bqgainingsectors",(function(e,t){e.query.mcsymbol;request("https://www.bloombergquint.com/feapi/markets/indices/sectoral-indices?duration=1D&tab=gaining",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcpv",(function(e,t){let o=e.query.mcsymbol;request("https://api.moneycontrol.com/mcapi/v1/stock/price-volume?scId="+o,(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/pharmadetails",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/notapplicable/inidicesindia/in%3Bcpr",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcniftyrealtime",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/notapplicable/inidicesindia/in%3BNSX",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcbankniftyrealtime",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/notapplicable/inidicesindia/in%3Bnbx",(function(e,o,n){console.log(e),e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcvixrealtime",(function(e,t){request("https://appfeeds.moneycontrol.com/jsonapi/market/indices&format=json&t_device=iphone&t_app=MC&t_version=48&ind_id=36",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcvixgraph",(function(e,t){request("https://appfeeds.moneycontrol.com/jsonapi/market/graph&format=json&ind_id=36&range=1d&type=area",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/cnxitd",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3Bcnit?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/cnxitw",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3Bcnit?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/cnxitm",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3Bcnit?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftymetald",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3BCNXM?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftymetalw",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3BCNXM?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/moneycontrolsnr",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/"+o+"?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/moneycontrolsnrindex",(function(e,t){let o=e.query.mcindexsymbol.replace(/;/,"%3B");request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/"+o+"?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/swot",(function(e,t){let o=e.query.mcsymbol;request("https://api.moneycontrol.com/mcapi/v1/extdata/mc-insights?scId="+o+"&type=d",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcswot",(function(e,t){let o=e.query.mcsymbol;request("https://api.moneycontrol.com/mcapi/v1/swot/details?scId="+o+"&type=all",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcsd",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/nse/equitycash/"+o,(function(e,o,n){e?console.log(e):e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsd1",(function(e,t){let o=e.query.mcsymbol1;request("https://priceapi.moneycontrol.com/pricefeed/nse/equitycash/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsd2",(function(e,t){let o=e.query.mcsymbol2;request("https://priceapi.moneycontrol.com/pricefeed/nse/equitycash/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/moneycontrolchartdata",(function(e,t){let o=e.query.mcsymbol;request("https://www.moneycontrol.com/mc/widget/stockdetails/getChartInfo?classic=true&scId="+o+"&type=N",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mchistoricalrating",(function(e,t){let o=e.query.mcsymbol;request("https://www.moneycontrol.com/mc/widget/historicalrating?classic=true&type=gson&indice_id="+o+"&period=D",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/moneycontrolsnrw",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/"+o+"?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/moneycontrolsnrm",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/"+o+"?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcti",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mctiw",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mctim",(function(e,t){let o=e.query.mcsymbol;request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftymetalm",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3BCNXM?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftyfind",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/in%3Bcnxf?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftyfinw",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/in%3Bcnxf?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/niftyfinm",(function(e,t){request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/in%3Bcnxf?fields=sentiments,pivotLevels,sma,ema",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsectors",(function(e,t){request("https://appfeeds.moneycontrol.com/appxml/indices_5_EN.json",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcsectorsdetailsd",(function(e,t){let o=e.query.mcsectorsymbol.replace(/;/,"%3B");request("https://priceapi.moneycontrol.com/pricefeed/techindicator/D/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsectorsdetailsw",(function(e,t){let o=e.query.mcsectorsymbol.replace(/;/,"%3B");request("https://priceapi.moneycontrol.com/pricefeed/techindicator/W/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsectorsdetailsm",(function(e,t){let o=e.query.mcsectorsymbol.replace(/;/,"%3B");request("https://priceapi.moneycontrol.com/pricefeed/techindicator/M/"+o+"?field=RSI",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/mcsectorgraph",(function(e,t){e.query.indid;request("https://appfeeds.moneycontrol.com//jsonapi//market//graph&format=json&ind_id=4&range=1d&type=area",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcstockdetails",(function(e,t){let o=e.query.mcindexid;request("https://appfeeds.moneycontrol.com/jsonapi/market/marketmap&format=json&type=0&ind_id="+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcstockdetails1",(function(e,t){let o=e.query.mcindexid1;request("https://appfeeds.moneycontrol.com/jsonapi/market/marketmap&format=json&type=0&ind_id="+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcindexchart",(function(e,t){let o=e.query.mcindexid;request("https://appfeeds.moneycontrol.com//jsonapi//market//graph&format=json&ind_id="+o+"&range=1d&type=area"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/trendingstocks",(function(e,t){request("https://www.moneycontrol.com/commonstore/commonfiles/trending_stocks.json?classic=true",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcoverall",(function(e,t){request("https://www.moneycontrol.com/mc/widget/mfnavonetimeinvestment/get_chart_value1?classic=true",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcchartsdataohlc",(function(e,t){e.query.mcsymbol;request("https://priceapi.moneycontrol.com/techCharts/techChartController/history?symbol=BEL&resolution=5&from=1619949639&to=1620042745",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/mcchartsdata",(function(e,t){let o=e.query.mcsymbol;request("https://www.moneycontrol.com/mc/widget/stockdetails/getChartInfo?classic=true&scId="+o+"&type=B",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/fnodata",(function(e,t){e.query.mcsymbol;request("https://www.moneycontrol.com/mc/widget/foaction?classic=true",(function(e,o,n){e||(html2json(o.body),t.json(html2json(o.body)))}))})),app.get("/sescreener",(function(e,t){request("https://api.stockedge.com/Api/FundamentalAlertsApi/GetSavedFundamentalAlertsByType/7002?relevantListings=10&page=1&pageSize=10&lang=en",(function(e,o,n){e||t.json(JSON.parse(o.body).data)}))})),app.get("/etimpdata",(function(e,t){e.query.stockid;request("https://json.bselivefeeds.indiatimes.com/marketband.json",(function(e,t,o){}))})),app.get("/etindices",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/getAllIndices?pagesize=100&marketcap=&exchange=nse",(function(e,o,n){e||t.json(JSON.parse(o.body))})),app.get("/etimesnews",(function(e,t){e.query.mcsymbol;request("https://economictimes.indiatimes.com/feed_marketslisting.cms?feedtype=json&msid=1977021501&curpg=1&callback=breakingnews",(function(e,o,n){e||t.json(o.body)}))})),app.get("/nsexchange",(function(e,t){e.query.mcsymbol;request("https://json.bselivefeeds.indiatimes.com/ET_Community/sectors?exchange=&callback=filterGetDataCBsectors",(function(e,o,n){e||t.json(o.body)}))})),app.get("/etsmacrossover",(function(e,t){e.query.mcsymbol;request("https://sas.indiatimes.com/TechnicalsClient/getSMA.htm?crossovertype=CROSSED_ABOVE_SMA_20&ctype=SMA&pagesize=25&exchange=50&exchangeid=50&pageno=1&sortby=volume&sortorder=desc&companyid=0&year=0&filtertype=0&ctype=SMA&marketcap=&indicatorName=EMA5&crossoverType=Bullish",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etvolumeshocker",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/volumeshocker?pagesize=25&exchange=50&pageno=1&sortby=volumepercentagechange&sortorder=desc&avgvolumeover=DAY_3&marketcap=largecap%2Cmidcap",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etsmabullishcrossover",(function(e,t){e.query.mcsymbol;request("https://etinsights.indiatimes.com/ET_TechnicalIndicator/getTechnicalDashboardData?pagesize=25&exchange=nse&pageno=1&sortby=percentChange&sortorder=desc&ctype=BUY_SELL_SIGNAL&indicatorName=EMA20&crossoverType=Bullish",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etnews",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/gainers?pagesize=50&pageno=1&sort=intraday&sortby=percentchange&sortorder=desc&marketcap=largecap%2Cmidcap%2Csmallcap&duration=1d",(function(e,o,n){e||t.json(JSON.parse(o.body))}))}))})),app.get("/et1",(function(e,t){e.query.mcsymbol;request("https://json.bselivefeeds.indiatimes.com/ET_Community/companypagedata?companyid=8581",(function(e,o,n){e||(console.log("et1"),t.json(JSON.parse(o.body)))}))})),app.get("/ethgainers",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/hourlygainers?pagesize=25&exchange=nse&pageno=1&service=gainers&sortby=percentchange&sortorder=desc&marketcap=largecap%2Cmidcap",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/ethlosers",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/hourlylosers?pagesize=25&exchange=nse&pageno=1&service=losers&sortby=percentchange&sortorder=asc&marketcap=largecap%2Cmidcap",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/Results",(function(e,t){e.query.mcsymbol;request("https://etmarketsapis.indiatimes.com/ET_Stats/boardMeeting?pagesize=50&pageno=1&sortby=meetingDateStr&sortorder=asc&companyid=0&year=0&filtertype=latest&duration=U&marketcap=All",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etmacdbuy",(function(e,t){e.query.mcsymbol;request("https://sas.indiatimes.com/TechnicalsClient/getMACD.htm?crossovertype=MACD_CROSSED_ABOVE_SIGNAL&ctype=MACD&pagesize=100&exchange=50&pageno=1&service=gainers&sortby=volume&sortorder=desc&ctype=MACD&marketcap=largecap%2Cmidcap%2Csmallcap",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etmacdsell",(function(e,t){e.query.mcsymbol;request("https://sas.indiatimes.com/TechnicalsClient/getMACD.htm?crossovertype=MACD_CROSSED_BELOW_SIGNAL&ctype=MACD&pagesize=100&exchange=50&pageno=1&service=gainers&sortby=volume&sortorder=desc&ctype=MACD&marketcap=largecap%2Cmidcap%2Csmallcap",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etcompanydataohlc",(function(e,t){let o=e.query.companyid;request("https://json.bselivefeeds.indiatimes.com/ET_Community/companypagedata?companyid="+o+"&companytype=",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etindexdetails",(function(e,t){let o=e.query.indexid,n=e.query.exchange;request("https://etmarketsapis.indiatimes.com/ET_Stats/getIndexByIds?indexid="+o+"&exchange="+n+"&pagesize=300&sortorder=desc&sortby=percentChange&company=true&pageno=1",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etsectors",(function(e,t){request("https://etmarketsapis.indiatimes.com/ET_Stats/sectorperformance?pagesize=3000&exchange=NSE&pageno=1&marketcap=",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etrecos",(function(e,t){request("https://economictimes.indiatimes.com/viewandrecofeed.cms?feedtype=sjson",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/etpost1",((e,t)=>{request("https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",(function(e,o,n){if(!e){chrome.getCookies("https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",(function(e,t){}));request({url:"https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",method:"POST",headers:{authority:"etmarketsapis.indiatimes.com","sec-ch-ua":'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"',accept:"application/json, text/javascript, */*; q=0.01",dnt:"1","sec-ch-ua-mobile":"?0","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36","content-type":"application/json",origin:"https://economictimes.indiatimes.com","sec-fetch-site":"same-site","sec-fetch-mode":"cors","sec-fetch-dest":"empty",referer:"https://economictimes.indiatimes.com/","accept-language":"en-US,en;q=0.9"},body:'{"predefinedFilterName":"VALUE_STOCKS","sortedField":"marketCapValue","pageSize":"20","sortedOrder":"desc","pageNumber":1,"exchangeId":"50","isBankingSector":"false","fieldNames":"*"}'},((e,o,n)=>{e||(t.json(JSON.parse(n)),console.log("this is response1:",o.body))}))}}))})),app.get("/etDIIBuying",((e,t)=>{request("https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",(function(e,o,n){if(!e){chrome.getCookies("https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",(function(e,t){}));request({url:"https://etmarketsapis.indiatimes.com/ET_Screeners/getFilteredData",method:"POST",headers:{authority:"etmarketsapis.indiatimes.com","sec-ch-ua":'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"',accept:"application/json, text/javascript, */*; q=0.01",dnt:"1","sec-ch-ua-mobile":"?0","user-agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36","content-type":"application/json",origin:"https://economictimes.indiatimes.com","sec-fetch-site":"same-site","sec-fetch-mode":"cors","sec-fetch-dest":"empty",referer:"https://economictimes.indiatimes.com/","accept-language":"en-US,en;q=0.9"},body:'{"predefinedFilterName":"DII_BUYING","sortedField":"marketCapValue","pageSize":"20","sortedOrder":"desc","pageNumber":1,"exchangeId":"50","isBankingSector":"false","fieldNames":"* latestQDate:latestQDateDii"}'},((e,o,n)=>{e||(t.json(JSON.parse(n)),console.log("this is response2:",o.body))}))}}))})),app.post("/etcompanydata",(async function(e,t){const o=e.body.map((e=>{axios.get("https://json.bselivefeeds.indiatimes.com/ET_Community/companypagedata?companyid="+e.companyid+"&companytype=").then((t=>{var o=[];data=t.data,data2=data.bseNseJson;for(let t in data2)o.push({indicator:data2[t].companyName2,stock:e.name,companyid:e.companyid})})).catch((e=>{console.log(e)}))}));try{await Promise.all(o)}catch(e){console.log(e)}})),app.get("/trendlynestocks1",((e,t)=>{let o=e.query.tlid,n=e.query.tlname,s=e.query.eqsymbol;console.log("This is tendlynestocks1"),request("https://trendlyne.com/equity/getStockMetricParameterList/"+o+"/",(function(e,a,i){if(!e){chrome.getCookies("https://trendlyne.com/equity/getStockMetricParameterList/"+o+"/",(function(e,t){}));var r={url:"https://trendlyne.com/equity/getStockMetricParameterList/"+o+"/",method:"GET",headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-US,en;q=0.9","sec-ch-ua":'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-requested-with":"XMLHttpRequest",cookie:process.env.trendlynecookie},referrer:"https://trendlyne.com/equity/"+o+"/"+s+"/"+n+"/",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors"};request(r,((e,o,n)=>{e||t.json(JSON.parse(n))}))}}))})),app.get("/trendlynestocks2",(function(e,t){let o=e.query.tlid;request("https://trendlyne.com/mapp/v1/stock/web/ohlc/"+o,(function(e,t,o){e||console.log("This is tendlynestocks2")}))})),app.get("/trendlynestocks3",(function(e,t){let o=e.query.tlid;request("https://trendlyne.com/fundamentals/get-fundamental_results/"+o+"/",(function(e,o,n){e?console.log(e):(console.log("This is tendlynestocks3"),t.json(o.body))}))})),app.get("/tltg",(function(e,t){let o=e.query.returnedname;request("https://trendlyne.com/fundamentals/json-screener/17096/10/0/index/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlfpg",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/price_gainers/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlfcg",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/contract_gainers/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlfmav",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/most_active_value/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlfmac",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/most_active_contract/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloig",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/oi_gainers/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloil",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/oi_losers/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloip",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/premium/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloipg",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/options/30-sep-2021-next/oi_gainers_put/all/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloid",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/discount/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tloicg",(function(e,t){request("https://trendlyne.com/futures-options/api-filter/futures/30-sep-2021-next/premium/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlropd",(function(e,t){request("https://trendlyne.com/fundamentals/json-screener/79796/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlropw",(function(e,t){request("https://trendlyne.com/fundamentals/json-screener/79795/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlrupd",(function(e,t){request("https://trendlyne.com/fundamentals/json-screener/79811/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlrupuw",(function(e,t){request("https://trendlyne.com/fundamentals/json-screener/79810/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tl52h",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/17110/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tl52l",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/17109/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlnear52h",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/17101/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){console.log(),e||t.json(JSON.parse(o.body))}))})),app.get("/tlnear52l",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/17102/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlvs",(function(e,t){let o=e.query.returnedname;request("https://trendlyne.com/fundamentals/json-screener/17097/10/0/index/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlrsiall",(function(e,t){request("https://trendlyne.com/fundamentals/json-screener/90234/3000/0/all/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlvhg",(function(e,t){let o=e.query.returnedname;request("https://trendlyne.com/fundamentals/json-screener/17099/10/0/index/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlvhl",(function(e,t){let o=e.query.returnedname;request("https://trendlyne.com/fundamentals/json-screener/17100/10/0/index/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlrvpd",(function(e,t){let o=e.query.returnedname;request("https://trendlyne.com/fundamentals/json-screener/9844/10/0/index/"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlbu",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/20014/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/tlob",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/27/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/nse",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/json-screener/9844/5/0/index/NIFTY500/nifty-500/",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/nse1",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/all-in-one-screener-data-get/?perPageCount=25&pageNumber=0&query=NP_Q_GROWTH+%3E+0&columns=NP_Q_GROWTH%2CcurrentPrice%2CNI1Q_Q%2CPE_TTM%2CPBV_A%2CPEG_TTM%2CREV1Q_Q&sortBy=NP_Q_GROWTH&order=DESC&groupType=all",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/nse2",(function(e,t){e.query.mcsymbol;request("https://trendlyne.com/fundamentals/all-in-one-screener-data-get/?perPageCount=50&pageNumber=0&query=FIIPCT1Q+%3E+0&columns=FIIPCT1Q%2CcurrentPrice%2Cday_changeP%2Cmonth_changeP%2CPROMPCT%2CPROMPCT1Q%2CPROMPLEDGE%2CFIIHOLD%2CMFHOLD&sortBy=FIIPCT1Q&order=DESC&groupType=all",(function(e,o,n){e||t.json(JSON.parse(o.body))}))}));const instancetrendlyne=axios.create({withCredentials:!0});axiosCookieJarSupport(instancetrendlyne),instancetrendlyne.defaults.jar=new tough.CookieJar,app.post("/trendlynepostdvm",(async function(e,t){const o=e.body.map((e=>{axios.get("https://trendlyne.com/mapp/v1/stock/web/ohlc/"+e.tlid).then((t=>{obj1={Date:e.Date,Time:e.time,Name:e.name,DurabilityScore:t.data.body.stockData[6],VolatilityScore:t.data.body.stockData[7],MomentumScore:t.data.body.stockData[8]}})).catch((e=>{console.log(e)}))}));try{await Promise.all(o)}catch(e){console.log(e)}})),app.get("/Gainers",(function(e,t){request("https://money.rediff.com/gainers",(function(e,o,n){if(!e){var s=cheerio.load(n),a=[],i=[],r=[],c=[],p=[],d=s("tbody").first();d.find("tr").length;d.find("tr").each((function(e,t){a[e]=s(this).find("td a").eq(0).text().trim(),i[e]=s(this).find("td").eq(1).text().trim(),r[e]=s(this).find("td").eq(2).text().trim(),c[e]=s(this).find("td font").eq(0).text().trim(),p.push({company:a[e],pClose:i[e],currentPrice:r[e],change:c[e]})})),t.setHeader("Content-Type","application/json"),t.send(JSON.stringify(p))}}))}));const instance=axios.create({withCredentials:!0});axiosCookieJarSupport(instance),instance.defaults.jar=new tough.CookieJar;const sessionConfig={secret:"MYSECRET",name:"amitstockweb",resave:!1,saveUninitialized:!1,cookie:{sameSite:"none"}};app.set("trust proxy",1),sessionConfig.cookie.secure=!0,app.use(session(sessionConfig)),app.get("/trendlynepost",(function(e,t){fetch("https://trendlyne.com/equity/api/getLivePriceList/",{headers:{accept:"application/json, text/javascript, */*; q=0.01","accept-language":"en-US,en;q=0.9","content-type":"application/x-www-form-urlencoded; charset=UTF-8","sec-ch-ua":'" Not;A Brand";v="99", "Google Chrome";v="91", "Chromium";v="91"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-csrftoken":"PTN4cA0cTjN9Zp1IwuZ7MhQ6rYdvMbGV","x-requested-with":"XMLHttpRequest",cookie:"csrftoken=PTN4cA0cTjN9Zp1IwuZ7MhQ6rYdvMbGV; _ga=GA1.2.2089860351.1627538215; _gid=GA1.2.1901289626.1627538215"},referrer:"https://trendlyne.com/features/",referrerPolicy:"strict-origin-when-cross-origin",body:"pks%5B%5D=1057&pks%5B%5D=1119&pks%5B%5D=1289&pks%5B%5D=1362&pks%5B%5D=1363&pks%5B%5D=1366&pks%5B%5D=1409&pks%5B%5D=147&pks%5B%5D=1887&pks%5B%5D=1888&pks%5B%5D=1895&pks%5B%5D=1896&pks%5B%5D=1898&pks%5B%5D=1900&pks%5B%5D=1902&pks%5B%5D=1905&pks%5B%5D=268&pks%5B%5D=276&pks%5B%5D=4482&pks%5B%5D=549&pks%5B%5D=629&pks%5B%5D=699&pks%5B%5D=79883&pks%5B%5D=804&pks%5B%5D=842&pks%5B%5D=878&pks%5B%5D=93115&force=false",method:"POST",mode:"cors"})})),app.get("/nsestockhistdata",(function(e,t){let o=e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/historical/cm/equity?symbol="+o+"&series=[%22EQ%22]&from=09-03-2021&to="+todaydate))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nseinstrading",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/corporates-pit?"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedatastockohlc2",(function(e,t){let o=e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/quote-equity?symbol="+o+"&section=trade_info"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nseresults",(function(e,t){instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/event-calendar?index=equities&subject=Financial%20Results")),{headers:{"User-Agent":"Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 5.0)",Referer:"http://www.nseindia.com/",Host:"http://www.nseindia.com/",Accept:"*/*",sameSite:"none"}}).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedatastockohlc1",(function(e,t){let o=e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/quote-equity?symbol="+o))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedata2",(function(e,t){instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/equity-stockIndices?index=NIFTY%2050"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedata4",(function(e,t){instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/liveEquity-derivatives?index=top20_contracts"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedataadvdec",(function(e,t){instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www1.nseindia.com/common/json/indicesAdvanceDeclines.json"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedataindices",(function(e,t){instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www1.nseindia.com/homepage/Indices1.json"))).then((e=>t.json(e.data)))})),app.get("/nsedatasioi",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www1.nseindia.com/live_market/dynaContent/live_analysis/oi_spurts/topPositiveOIChangeData.json"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedatapioii",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www1.nseindia.com/live_market/dynaContent/live_analysis/oi_spurts/riseInPriceRiseInOI.json"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedataniftyoi",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/option-chain-indices?symbol=NIFTY"))).then((e=>t.json(e.data)))})),app.get("/nsedatabniftyoi",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/option-chain-indices?symbol=BANKNIFTY"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedatapniftyoi",(function(e,t){e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/option-chain-indices?symbol=BANKNIFTY"))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nsedatastockoi",(function(e,t){let o=e.query.stock;instance.get("https://www.nseindia.com/").then((e=>instance.get("https://www.nseindia.com/api/option-chain-equities?symbol="+o))).then((e=>t.json(e.data))).catch((e=>console.error(t.response)))})),app.get("/nse22",(function(e,t){e.query.mcsymbol;return axios.get("https://www1.nseindia.com/corporates/corpInfo/equities/getResultCalendar.jsp?Symbol=&Industry=&Period=All%20Forthcoming&Purpose=&period=All%20Forthcoming&symbol=&industry=&purpose=")})),app.post("/nsepostdata1",(async function(e,t){let o=e.body;const n=o.map((e=>{instance.get("https://www.nseindia.com/").then((t=>instance.get("https://www.nseindia.com/api/quote-equity?symbol="+e.eqsymbol1+"&section=trade_info"))).then((t=>{t.data.securityWiseDP.deliveryToTradedQuantity?{symbol:e.eqsymbol1,percentage:t.data.securityWiseDP.deliveryToTradedQuantity}:console.log("No deliveryToTradedQuantity present ")})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)})).catch((e=>console.error("There is error")));try{await Promise.all(n)}catch(e){console.log(e)}})),app.post("/nsepostdata2",(async function(e,t){const o=e.body.map((e=>{instance.get("https://www.nseindia.com/").then((t=>instance.get("https://www.nseindia.com/api/option-chain-equities?symbol="+e.eqsymbol1))).then((t=>{if(t.data.filtered.CE.totOI&&t.data.filtered.PE.totOI)e.eqsymbol1,t.data.filtered.PE.totOI,t.data.filtered.CE.totOI;else console.log("No Put/Call present ")})).catch((e=>{console.log(e)}))})).catch((e=>{console.log(e)})).catch((e=>console.error("There is error")));try{await Promise.all(o)}catch(e){console.log(e)}})),app.get("/opstraexpirydates",(function(e,t){request("https://opstra.definedge.com/api/weeklies",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/opstraexpirydatesmonthly",(function(e,t){request("https://opstra.definedge.com/api/monthlies",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/opstradatanifty",(function(e,t){let o=e.query.nextexpiry;request("https://opstra.definedge.com/api/openinterest/free/NIFTY&"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/opstradatabanknifty",(function(e,t){let o=e.query.nextexpiry;request("https://opstra.definedge.com/api/openinterest/free/NIFTY&"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/opstrastockdata",(function(e,t){let o=e.query.nextexpirymonthly,n=e.query.eqsymbol;request("https://opstra.definedge.com/api/openinterest/free/"+n+"&"+o,(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/kite1",(function(e,t){let o=e.query.timeframe,n=e.query.eqsymbol;request("https://mo.streak.tech/api/tech_analysis/?timeFrame="+o+"&stock=NSE%3A"+n+"&user_id=",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/kitestockreports",csrfProtection,((e,t)=>{request("https://stockreports.zerodha.com/api/pdf/",(function(e,o,n){if(!e){chrome.getCookies("https://stockreports.zerodha.com/api/pdf/",(function(e,t){console.log(t),this.cookies1=t,this.csrf=t.csrftoken,this.ga=t._ga,this.gid=t._gid,this.publictoken=t.public_token,this.messages='"5fa53faffe273135c32025277005d525349a6411$[[\\"__json_message\\"\\0540\\05425\\054\\"Successfully signed in as kanchan.kapila.2020@gmail.com.\\"]]"',this.sessionid=t.sessionid,this.gatag=t._gat_gtag_UA_29026012_19,this.finalcookie="'_ga="+this.ga+"; _gid="+this.gid+"; public_token="+this.publictoken+"; messages="+this.messages+"; csrftoken="+this.csrf+"; sessionid="+this.sessionid+"'"}));var s={url:"https://stockreports.zerodha.com/api/pdf/",method:"GET",headers:{accept:"application/json, text/plain, */*","accept-language":"en-US,en;q=0.9","sec-ch-ua":'"Chromium";v="92", " Not A;Brand";v="99", "Google Chrome";v="92"',"sec-ch-ua-mobile":"?0","sec-fetch-dest":"empty","sec-fetch-mode":"cors","sec-fetch-site":"same-origin","x-csrftoken":this.csrf,cookie:this.finalcookie},referrer:"https://stockreports.zerodha.com/ratings",referrerPolicy:"strict-origin-when-cross-origin",body:null,method:"GET",mode:"cors"};request(s,((e,o,n)=>{e||t.json(JSON.parse(o.body))}))}}))})),app.get("/niftytradersallstocks",(function(e,t){request("https://api.niftytrader.in/api/NIndex/stocks_list_api",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/ntniftypcr",(function(e,t){request("https://api.niftytrader.in/api/FinNiftyOI/niftypcrData?reqType=niftypcr",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/gnewsapi",(function(e,t){e.query.stockname.replace(/ /,"%20A");let o=e.query.stockname.replace(" Ltd.","");request("https://newsapi.org/v2/everything?q=%22"+o+"%22&from="+gnewsyesterday+"&to="+gnewsdatetoday+"&sortBy=popularity&apiKey=28bda70739cc4024ba3f30223e8c25a8",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.get("/gnewsapiall",(function(e,t){request("https://newsapi.org/v2/everything?domains=moneycontrol.com,economictimes.indiatimes.com&from="+gnewsyesterday+"&to="+gnewsdatetoday+"&sortBy=popularity&apiKey=28bda70739cc4024ba3f30223e8c25a8",(function(e,o,n){e||t.json(JSON.parse(o.body))}))})),app.use(express.static(__dirname+"/dist")),app.get("/*",(function(e,t){t.sendFile(path.join(__dirname+"/dist/index.html"))})),app.get("/ngsw-worker.js",(function(e,t){t.sendFile(path.resolve(__dirname,"/dist/","ngsw-worker.js"))})),http.createServer({},app).listen(3e3,(function(){console.log("Example app listening on port 3000! Go to https://localhost:3000/")}));